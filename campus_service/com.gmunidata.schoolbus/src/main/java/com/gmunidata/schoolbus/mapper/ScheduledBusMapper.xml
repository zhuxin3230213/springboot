<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.gmunidata.schoolbus.mapper.ScheduledBusMapper">

    <insert id="addScheduledBus" parameterType="com.gmunidata.schoolbus.model.ScheduledBus">
        INSERT INTO sc_gmuni_scheduled_bus (id,season,running_time_type,origin,destination,riding_point,time,bus_code,driver_code) VALUES(
          #{id,jdbcType=VARCHAR},#{season,jdbcType=VARCHAR},#{runningTimeType,jdbcType=VARCHAR},#{origin,jdbcType=VARCHAR},#{destination,jdbcType=VARCHAR},
          #{ridingPoint,jdbcType=VARCHAR},#{time,jdbcType=VARCHAR},#{busCode,jdbcType=VARCHAR},#{driverCode,jdbcType=VARCHAR})
    </insert>

    <update id="updateScheduledBus">
        update sc_gmuni_scheduled_bus set
        season=#{season,jdbcType=VARCHAR},
        running_time_type=#{runningTimeType,jdbcType=VARCHAR},
        origin=#{origin,jdbcType=VARCHAR},
        destination=#{destination,jdbcType=VARCHAR},
        riding_point=#{ridingPoint,jdbcType=VARCHAR},
        time=#{time,jdbcType=VARCHAR},
        bus_code=#{busCode,jdbcType=VARCHAR},
        driver_code=#{driverCode,jdbcType=VARCHAR},
        where id=#{idjdbcType=VARCHAR}
    </update>

    <delete id="delScheduledBus" parameterType="java.lang.String">
        delete from sc_gmuni_scheduled_bus where id in(
        <foreach collection="list" item="item" separator=",">
            #{item}
        </foreach>
        )
    </delete>

    <select id="getSchoolSeasonList" resultType="java.lang.String">

                   SELECT
	                     season
	                FROM
	                     sc_gmuni_scheduled_bus
   </select>

    <select id="getSchoolBusTimeList" parameterType="java.util.Map" resultType="java.util.Map">

        SELECT
        s.riding_point as address,
        s.time as sTime
        FROM
        sc_gmuni_scheduled_bus s
        where
        <if test="season != null and season != ''">
            s.season != #{season,jdbcType=VARCHAR}
        </if>
        <if test="week != null and week != ''">
            and s.running_time_type = #{week,jdbcType=VARCHAR}
        </if>
        <if test="startCampus != null and startCampus != ''">
            and s.origin = #{startCampus,jdbcType=VARCHAR}
        </if>
        <if test="endCampus != null and endCampus != ''">
            and s.destination = #{endCampus,jdbcType=VARCHAR}
        </if>
    </select>
    <select id="getSchoolCampusList" resultType="java.util.Map">
                   SELECT
                          l.code AS code,
                          l.name AS name
                   FROM pf_gmuni_lookup l
                   WHERE l.parent_id = (SELECT
                                           id
                                          FROM pf_gmuni_lookup
                                          WHERE CODE = 'xq')
    </select>

</mapper>